/*
 *   This file is part of DroneBridge: https://github.com/seeul8er/DroneBridge
 *
 *   Copyright 2019 Wolfgang Christl
 *
 *   Licensed under the Apache License, Version 2.0 (the "License");
 *   you may not use this file except in compliance with the License.
 *   You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 *   Unless required by applicable law or agreed to in writing, software
 *   distributed under the License is distributed on an "AS IS" BASIS,
 *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *   See the License for the specific language governing permissions and
 *   limitations under the License.
 *
 */

#ifndef DRONEBRIDGE_DB_USB_H
#define DRONEBRIDGE_DB_USB_H

#define DB_USB_PROTO_VERSION    1

#define DB_USB_PARSER_SEARCHING_HEADER  0   // wait for header to arrive at start of USB packet buffer
#define DB_USB_PARSER_AWAITING_PAYLOAD  1   // wait for payload completion

#define MAX_POLL_FDS                    20
#define DB_USB_PORT_TIMEOUT_WAKE        255

struct poll_fd_count_t {
    int total_poll_fd_cnt;
    int usb_poll_fd_cnt;
};

// #define DUMM_PAY_SIZE 1020u
// uint8_t dummy_payload[DUMM_PAY_SIZE] = {235, 175, 151, 223, 71, 54, 92, 98, 246, 193, 54, 124, 40, 59, 108, 14, 119, 91, 56, 21, 253, 94, 196, 58, 115, 99, 56, 140, 36, 2, 35, 85, 23, 0, 209, 206, 25, 78, 103, 130, 228, 9, 100, 75, 22, 73, 104, 40, 123, 152, 170, 128, 44, 13, 182, 49, 116, 112, 220, 43, 41, 35, 164, 106, 186, 114, 52, 29, 100, 162, 44, 25, 70, 101, 77, 76, 217, 156, 120, 22, 173, 144, 238, 183, 230, 38, 249, 18, 244, 106, 188, 90, 69, 100, 45, 201, 171, 76, 140, 138, 173, 82, 53, 243, 84, 5, 174, 113, 127, 105, 212, 80, 103, 236, 236, 223, 38, 131, 93, 148, 167, 210, 200, 127, 194, 101, 9, 92, 58, 118, 180, 124, 127, 123, 242, 146, 124, 81, 198, 172, 135, 149, 77, 193, 127, 44, 175, 219, 161, 48, 216, 233, 45, 140, 236, 90, 19, 143, 180, 121, 231, 23, 170, 160, 27, 39, 135, 90, 39, 232, 91, 151, 86, 180, 102, 87, 52, 159, 78, 32, 49, 146, 171, 8, 2, 218, 111, 212, 30, 4, 129, 250, 128, 10, 6, 28, 143, 210, 113, 168, 92, 79, 56, 42, 11, 241, 151, 24, 240, 206, 211, 21, 138, 207, 213, 204, 241, 156, 3, 168, 149, 4, 58, 158, 122, 153, 197, 127, 247, 239, 154, 206, 121, 62, 77, 181, 170, 48, 64, 122, 82, 101, 47, 194, 202, 66, 190, 139, 2, 208, 41, 239, 21, 102, 114, 213, 126, 251, 22, 108, 158, 95, 202, 159, 251, 86, 48, 52, 229, 244, 45, 41, 37, 205, 86, 29, 249, 65, 81, 25, 58, 142, 249, 95, 213, 44, 111, 47, 109, 185, 148, 169, 216, 254, 179, 88, 116, 101, 236, 251, 177, 232, 105, 241, 115, 91, 221, 125, 206, 172, 126, 193, 92, 86, 219, 24, 129, 251, 74, 42, 149, 42, 131, 69, 40, 201, 4, 174, 148, 153, 185, 130, 120, 162, 68, 164, 110, 220, 199, 54, 90, 26, 90, 219, 73, 32, 21, 241, 104, 220, 37, 7, 185, 24, 255, 188, 206, 160, 226, 7, 46, 110, 219, 38, 37, 112, 171, 33, 126, 210, 159, 237, 137, 66, 1, 188, 79, 173, 69, 97, 125, 158, 225, 146, 142, 47, 223, 46, 91, 95, 8, 24, 215, 50, 141, 211, 218, 226, 207, 195, 233, 117, 39, 171, 25, 151, 144, 152, 31, 83, 251, 242, 66, 200, 68, 251, 169, 147, 116, 160, 254, 29, 64, 223, 122, 218, 13, 123, 19, 161, 104, 226, 67, 219, 55, 100, 254, 109, 114, 63, 128, 33, 108, 39, 128, 102, 182, 108, 85, 83, 124, 157, 224, 158, 101, 28, 18, 158, 100, 58, 67, 53, 21, 98, 253, 141, 236, 184, 219, 254, 201, 123, 122, 164, 29, 226, 187, 66, 182, 41, 25, 168, 239, 237, 113, 121, 93, 114, 124, 197, 123, 63, 175, 118, 94, 200, 111, 25, 125, 3, 79, 78, 213, 104, 128, 41, 83, 165, 176, 202, 63, 46, 135, 88, 212, 234, 200, 111, 70, 238, 45, 131, 59, 58, 43, 92, 118, 38, 20, 72, 83, 170, 221, 141, 109, 224, 242, 181, 46, 141, 39, 75, 143, 183, 205, 225, 22, 130, 106, 139, 3, 48, 91, 185, 52, 85, 72, 161, 138, 12, 153, 66, 97, 180, 48, 169, 197, 215, 138, 184, 79, 41, 12, 44, 174, 81, 42, 53, 26, 18, 57, 225, 199, 10, 122, 48, 60, 82, 229, 93, 219, 85, 65, 49, 35, 57, 220, 248, 82, 64, 88, 229, 62, 129, 214, 100, 177, 101, 137, 54, 103, 208, 31, 194, 101, 177, 251, 109, 119, 155, 81, 193, 168, 80, 239, 176, 133, 22, 23, 18, 7, 157, 87, 16, 46, 208, 84, 18, 55, 75, 173, 168, 185, 19, 88, 78, 152, 250, 73, 84, 102, 78, 185, 248, 87, 139, 3, 147, 238, 51, 213, 27, 15, 215, 47, 83, 91, 240, 179, 192, 21, 189, 68, 154, 29, 29, 114, 212, 229, 81, 251, 16, 132, 148, 84, 3, 82, 31, 60, 80, 56, 108, 113, 167, 108, 91, 239, 88, 165, 74, 222, 215, 150, 31, 245, 74, 101, 251, 166, 112, 178, 41, 189, 146, 109, 249, 168, 88, 5, 186, 228, 153, 244, 201, 245, 54, 50, 189, 107, 138, 222, 168, 66, 170, 189, 49, 182, 219, 90, 152, 159, 200, 130, 130, 121, 157, 101, 229, 171, 187, 93, 15, 22, 191, 66, 197, 203, 162, 57, 28, 228, 71, 3, 44, 28, 29, 104, 160, 115, 166, 7, 5, 134, 45, 243, 78, 64, 78, 16, 12, 135, 95, 251, 91, 116, 78, 205, 121, 131, 247, 206, 75, 175, 172, 130, 83, 121, 118, 69, 66, 249, 60, 43, 171, 170, 184, 60, 147, 86, 5, 37, 166, 130, 147, 28, 141, 177, 129, 201, 80, 110, 113, 98, 212, 165, 216, 72, 242, 18, 238, 244, 9, 37, 254, 73, 1, 248, 108, 134, 148, 110, 12, 249, 32, 237, 217, 108, 76, 91, 27, 9, 7, 120, 224, 133, 156, 67, 242, 199, 12, 23, 163, 96, 213, 83, 209, 151, 50, 181, 198, 85, 40, 243, 125, 15, 7, 3, 166, 223, 119, 213, 94, 167, 213, 109, 145, 57, 243, 86, 233, 102, 62, 232, 226, 198, 217, 110, 45, 62, 14, 49, 112, 73, 233, 167, 17, 203, 20, 161, 179, 46, 71, 77, 160, 243, 11, 70, 108, 144, 236, 213, 30, 150, 253, 188, 107, 218, 93, 101, 39, 133, 70, 5, 138, 163, 251, 123, 10, 123, 241, 118, 161, 49, 153, 207, 79, 15, 170, 139, 230, 210, 202, 77, 108, 60, 120, 137, 117, 127, 59, 176, 181, 110, 243, 42, 103, 46, 67, 10, 93, 23, 166, 221, 119, 115, 203, 92, 48, 7, 178, 143, 204, 202, 106, 92, 117, 167, 170, 139, 68, 213, 9, 239, 245, 163, 12, 98, 222, 16, 56, 141, 90, 23, 140, 5, 218, 41, 121, 74, 251, 174, 32, 2, 117, 58, 165, 227, 203, 107, 21};

#endif //DRONEBRIDGE_DB_USB_H
